from pyrogram import *
from pyrogram.types import *
import os
import re
import time
from info import API_ID, API_HASH
from database.connections_mdb import add_bot


@Client.on_message(filters.private & filters.command("clone"))
async def clone(bot, msg: Message):
    chat = msg.chat
    text1 = await msg.reply("<b>H·¥á è B Ä·¥è Us·¥á C·¥è Ä Ä·¥á·¥Ñ·¥õ M·¥á·¥õ ú·¥è·¥Ö\n\nE…¢ : <code>/clone [bot token]</code></b>")
    cmd = msg.command
    phone = msg.command[1]
    bot_id1 = msg.text.split(":")[0]
    try:
        await text1.edit("<b>T Ä è…™…¥…¢ T·¥è C·¥è…¥…¥·¥á·¥Ñ·¥õ Y·¥è·¥ú Ä B·¥è·¥õ...</b>")
                  
        client = Client(bot_id1 + "_0", API_ID, API_HASH, bot_token=phone, plugins={"root": "Clone"})
        await client.start()
        idle()
        user = await client.get_me()
        bot_id = user.id
        user_id = msg.from_user.id
        await text1.delete()
        await add_bot(str(bot_id), str(user_id))
        await msg.reply(f"<b>H·¥á è B Ä·¥è Y·¥è·¥ú B·¥è·¥õ H·¥Äs B·¥á·¥á…¥ S·¥õ·¥Ä Ä·¥õ·¥á·¥Ö As @{user.username} ‚úÖ \n\nA·¥Ö·¥Ö T·¥è Y·¥è·¥ú Ä G Ä·¥è·¥ú·¥ò A…¥·¥Ö E…¥·¥ä·¥è è.. üì£</b>")
     
    except Exception as e:
        await text1.delete()
        await msg.reply(f"**‚ùå E Ä Ä·¥è Ä :**\n\n`{str(e)}`\n\nI“ì H·¥Ä·¥†·¥á A…¥ è D·¥è·¥ú ô·¥õ As·¥ã I…¥ S·¥ú·¥ò·¥ò·¥è Ä·¥õ ‚ùó")
        
@Client.on_message(filters.private & filters.command("mybots"))
async def mybots(client, message):
    user_id = message.from_user.id
    bot_id = await all_bot(str(user_id))
    if bot_id:
        ttle = bot_id.title
        btn = [[
            InlineKeyboardButton(
                f'{ttle}', callback_data=f"mybot2#{bot_id}"
            )
        ]]
        await message.reply_text('Hey ! Choose A From Given Below', reply_markup=InlineKeyboardMarkup(btn))
    else:
        await message.reply_text('Hey First Create A Bot Then Try Again ):')
                
                
                
                
                
                
                
